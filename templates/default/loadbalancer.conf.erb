<VirtualHost *:1080>

  ServerAdmin webmaster@localhost
  DocumentRoot /var/www/html

  SSLEngine on
  
  SSLCertificateFile 
  SSLCertificateKeyFile

  SSLProxyEngine on
  
  ErrorLog <%= @load_balancer_log_dir %>/error.log
  CustomLog <%= @load_balancer_log_dir %>/access.log combined
  
  <Proxy balancer://hopsworkscluster>
      <% @glassfish_nodes.each do |ipaddress| %>
        BalancerMember <%= "https://#{ipaddress}:#{node['hopsworks']['internal']['port']}" %>
      <% end %>
  </Proxy>

  ProxyPreserveHost On
  ProxyPass         /  balancer://hopsworkscluster/
  ProxyPassReverse  /  balancer://hopsworkscluster/
</VirtualHost>